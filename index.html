<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Crucigramas (Modo Anagrama)</title>
    <style>
        :root {
            --cell-size: 45px;
            --primary-color: #8e44ad; /* Morado para estilo 'juego de palabras' */
            --success-color: #27ae60;
            --error-color: #c0392b;
            --bg-color: #ecf0f1;
        }

        body {
            font-family: 'Verdana', sans-serif;
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #2c3e50;
        }

        h1 {
            text-align: center;
            margin-bottom: 5px;
        }
        
        p.subtitle {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-bottom: 20px;
            max-width: 600px;
            text-align: center;
        }

        .controls {
            margin-bottom: 25px;
            display: flex;
            gap: 15px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.1s, box-shadow 0.1s;
        }

        button:active {
            transform: translateY(2px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .btn-new {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-check {
            background-color: #f39c12;
            color: white;
        }

        .game-area {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            justify-content: center;
            align-items: flex-start;
            width: 100%;
            max-width: 1200px;
        }

        /* Grid Styles */
        #crossword-grid {
            display: grid;
            gap: 4px;
            padding: 10px;
            background-color: #bdc3c7;
            border-radius: 8px;
        }

        .cell {
            width: var(--cell-size);
            height: var(--cell-size);
            background-color: #bdc3c7;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .cell-input {
            width: 100%;
            height: 100%;
            border: 2px solid #fff;
            border-radius: 4px;
            text-align: center;
            font-size: 1.4rem;
            font-weight: bold;
            text-transform: uppercase;
            background-color: white;
            color: #2c3e50;
            outline: none;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
        }

        .cell-input:focus {
            border-color: var(--primary-color);
            background-color: #fbfaff;
        }

        .cell-empty {
            visibility: hidden;
        }

        .cell.correct .cell-input {
            background-color: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .cell.incorrect .cell-input {
            background-color: var(--error-color);
            color: white;
            border-color: var(--error-color);
        }

        .cell-number {
            position: absolute;
            top: 2px;
            left: 4px;
            font-size: 0.65rem;
            color: #7f8c8d;
            z-index: 2;
            pointer-events: none;
            font-weight: bold;
        }

        /* Clues Styles */
        .clues-panel {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            min-width: 280px;
            max-width: 350px;
        }

        .clue-group h3 {
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 8px;
            margin-top: 0;
            color: var(--primary-color);
        }

        .clue-item {
            margin-bottom: 12px;
            font-size: 1rem;
            line-height: 1.4;
        }

        .clue-badge {
            background-color: var(--primary-color);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-right: 8px;
            font-weight: bold;
        }

        /* Base word highlight */
        .base-word-info {
            margin-bottom: 20px;
            padding: 10px;
            background-color: #e8daef;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #d2b4de;
        }

        @media (max-width: 768px) {
            :root { --cell-size: 35px; }
            .game-area { flex-direction: column; align-items: center; }
            .clues-panel { width: 90%; }
        }
    </style>
</head>
<body>

    <h1>üß© Crucigrama "Letras Ocultas"</h1>
    <p class="subtitle">Las palabras cruzadas se forman usando <strong>solo</strong> las letras de la palabra principal.</p>
    
    <div class="controls">
        <button class="btn-new" onclick="initGame()">üîÑ Generar Nuevo</button>
        <button class="btn-check" onclick="checkAnswers()">‚úÖ Comprobar</button>
    </div>

    <div class="game-area">
        <div id="crossword-grid"></div>

        <div class="clues-panel">
            <div id="base-word-display" class="base-word-info">
                </div>

            <div class="clue-group">
                <h3>Horizontales</h3>
                <div id="clues-horizontal"></div>
            </div>
            <div class="clue-group" style="margin-top: 25px;">
                <h3>Verticales</h3>
                <div id="clues-vertical"></div>
            </div>
        </div>
    </div>

<script>
    // --- BASE DE DATOS (JSON COMPLETO) ---
    const vocabulario = [
  { "palabra": "yo", "traduccion_ingles": "I" },
  { "palabra": "t√∫", "traduccion_ingles": "you (singular informal)" },
  { "palabra": "√©l", "traduccion_ingles": "he" },
  { "palabra": "ella", "traduccion_ingles": "she" },
  { "palabra": "usted", "traduccion_ingles": "you (singular formal)" },
  { "palabra": "nosotros", "traduccion_ingles": "we (masculine/mixed)" },
  { "palabra": "nosotras", "traduccion_ingles": "we (feminine)" },
  { "palabra": "vosotros", "traduccion_ingles": "you (plural informal masculine/mixed)" },
  { "palabra": "vosotras", "traduccion_ingles": "you (plural informal feminine)" },
  { "palabra": "ellos", "traduccion_ingles": "they (masculine/mixed)" },
  { "palabra": "ellas", "traduccion_ingles": "they (feminine)" },
  { "palabra": "ustedes", "traduccion_ingles": "you (plural formal/informal Latin America)" },
  { "palabra": "espa√±ol", "traduccion_ingles": "Spanish (nationality)" },
  { "palabra": "espa√±ola", "traduccion_ingles": "Spanish (nationality)" },
  { "palabra": "mexicano", "traduccion_ingles": "Mexican" },
  { "palabra": "mexicana", "traduccion_ingles": "Mexican" },
  { "palabra": "franc√©s", "traduccion_ingles": "French" },
  { "palabra": "francesa", "traduccion_ingles": "French" },
  { "palabra": "estadounidense", "traduccion_ingles": "American (USA)" },
  { "palabra": "canadiense", "traduccion_ingles": "Canadian" },
  { "palabra": "ingl√©s", "traduccion_ingles": "English" },
  { "palabra": "inglesa", "traduccion_ingles": "English" },
  { "palabra": "alem√°n", "traduccion_ingles": "German" },
  { "palabra": "alemana", "traduccion_ingles": "German" },
  { "palabra": "italiano", "traduccion_ingles": "Italian" },
  { "palabra": "italiana", "traduccion_ingles": "Italian" },
  { "palabra": "chino", "traduccion_ingles": "Chinese" },
  { "palabra": "china", "traduccion_ingles": "Chinese" },
  { "palabra": "japon√©s", "traduccion_ingles": "Japanese" },
  { "palabra": "japonesa", "traduccion_ingles": "Japanese" },
  { "palabra": "coreano", "traduccion_ingles": "Korean" },
  { "palabra": "coreana", "traduccion_ingles": "Korean" },
  { "palabra": "hola", "traduccion_ingles": "hello / hi" },
  { "palabra": "adi√≥s", "traduccion_ingles": "goodbye" },
  { "palabra": "gracias", "traduccion_ingles": "thank you" },
  { "palabra": "perd√≥n", "traduccion_ingles": "sorry / excuse me" },
  { "palabra": "encantado", "traduccion_ingles": "pleased to meet you (male)" },
  { "palabra": "encantada", "traduccion_ingles": "pleased to meet you (female)" },
  { "palabra": "qu√©", "traduccion_ingles": "what" },
  { "palabra": "qui√©n", "traduccion_ingles": "who (singular)" },
  { "palabra": "d√≥nde", "traduccion_ingles": "where" },
  { "palabra": "cu√°ndo", "traduccion_ingles": "when" },
  { "palabra": "c√≥mo", "traduccion_ingles": "how" },
  { "palabra": "familia", "traduccion_ingles": "family" },
  { "palabra": "padre", "traduccion_ingles": "father" },
  { "palabra": "madre", "traduccion_ingles": "mother" },
  { "palabra": "padres", "traduccion_ingles": "parents" },
  { "palabra": "hijo", "traduccion_ingles": "son" },
  { "palabra": "hija", "traduccion_ingles": "daughter" },
  { "palabra": "hermano", "traduccion_ingles": "brother" },
  { "palabra": "hermana", "traduccion_ingles": "sister" },
  { "palabra": "abuelo", "traduccion_ingles": "grandfather" },
  { "palabra": "abuela", "traduccion_ingles": "grandmother" },
  { "palabra": "t√≠o", "traduccion_ingles": "uncle" },
  { "palabra": "t√≠a", "traduccion_ingles": "aunt" },
  { "palabra": "primo", "traduccion_ingles": "cousin (male)" },
  { "palabra": "prima", "traduccion_ingles": "cousin (female)" },
  { "palabra": "profesor", "traduccion_ingles": "teacher (male)" },
  { "palabra": "profesora", "traduccion_ingles": "teacher (female)" },
  { "palabra": "estudiante", "traduccion_ingles": "student" },
  { "palabra": "m√©dico", "traduccion_ingles": "doctor (male)" },
  { "palabra": "m√©dica", "traduccion_ingles": "doctor (female)" },
  { "palabra": "enfermero", "traduccion_ingles": "nurse (male)" },
  { "palabra": "enfermera", "traduccion_ingles": "nurse (female)" },
  { "palabra": "cocinero", "traduccion_ingles": "cook / chef (male)" },
  { "palabra": "cocinera", "traduccion_ingles": "cook / chef (female)" },
  { "palabra": "polic√≠a", "traduccion_ingles": "police officer" },
  { "palabra": "camarero", "traduccion_ingles": "waiter" },
  { "palabra": "camarera", "traduccion_ingles": "waitress" },
  { "palabra": "secretario", "traduccion_ingles": "secretary (male)" },
  { "palabra": "secretaria", "traduccion_ingles": "secretary (female)" },
  { "palabra": "taxista", "traduccion_ingles": "taxi driver" },
  { "palabra": "cero", "traduccion_ingles": "zero" },
  { "palabra": "uno", "traduccion_ingles": "one" },
  { "palabra": "dos", "traduccion_ingles": "two" },
  { "palabra": "tres", "traduccion_ingles": "three" },
  { "palabra": "cuatro", "traduccion_ingles": "four" },
  { "palabra": "cinco", "traduccion_ingles": "five" },
  { "palabra": "seis", "traduccion_ingles": "six" },
  { "palabra": "siete", "traduccion_ingles": "seven" },
  { "palabra": "ocho", "traduccion_ingles": "eight" },
  { "palabra": "nueve", "traduccion_ingles": "nine" },
  { "palabra": "diez", "traduccion_ingles": "ten" },
  { "palabra": "once", "traduccion_ingles": "eleven" },
  { "palabra": "doce", "traduccion_ingles": "twelve" },
  { "palabra": "trece", "traduccion_ingles": "thirteen" },
  { "palabra": "catorce", "traduccion_ingles": "fourteen" },
  { "palabra": "quince", "traduccion_ingles": "fifteen" },
  { "palabra": "veinte", "traduccion_ingles": "twenty" },
  { "palabra": "treinta", "traduccion_ingles": "thirty" },
  { "palabra": "cuarenta", "traduccion_ingles": "forty" },
  { "palabra": "cincuenta", "traduccion_ingles": "fifty" },
  { "palabra": "sesenta", "traduccion_ingles": "sixty" },
  { "palabra": "setenta", "traduccion_ingles": "seventy" },
  { "palabra": "ochenta", "traduccion_ingles": "eighty" },
  { "palabra": "noventa", "traduccion_ingles": "ninety" },
  { "palabra": "cien", "traduccion_ingles": "one hundred" },
  { "palabra": "lunes", "traduccion_ingles": "Monday" },
  { "palabra": "martes", "traduccion_ingles": "Tuesday" },
  { "palabra": "mi√©rcoles", "traduccion_ingles": "Wednesday" },
  { "palabra": "jueves", "traduccion_ingles": "Thursday" },
  { "palabra": "viernes", "traduccion_ingles": "Friday" },
  { "palabra": "s√°bado", "traduccion_ingles": "Saturday" },
  { "palabra": "domingo", "traduccion_ingles": "Sunday" },
  { "palabra": "enero", "traduccion_ingles": "January" },
  { "palabra": "febrero", "traduccion_ingles": "February" },
  { "palabra": "marzo", "traduccion_ingles": "March" },
  { "palabra": "abril", "traduccion_ingles": "April" },
  { "palabra": "mayo", "traduccion_ingles": "May" },
  { "palabra": "junio", "traduccion_ingles": "June" },
  { "palabra": "julio", "traduccion_ingles": "July" },
  { "palabra": "agosto", "traduccion_ingles": "August" },
  { "palabra": "septiembre", "traduccion_ingles": "September" },
  { "palabra": "octubre", "traduccion_ingles": "October" },
  { "palabra": "noviembre", "traduccion_ingles": "November" },
  { "palabra": "diciembre", "traduccion_ingles": "December" },
  { "palabra": "primavera", "traduccion_ingles": "spring" },
  { "palabra": "verano", "traduccion_ingles": "summer" },
  { "palabra": "oto√±o", "traduccion_ingles": "autumn / fall" },
  { "palabra": "invierno", "traduccion_ingles": "winter" },
  { "palabra": "tiempo", "traduccion_ingles": "weather" },
  { "palabra": "sol", "traduccion_ingles": "sun" },
  { "palabra": "calor", "traduccion_ingles": "heat" },
  { "palabra": "fr√≠o", "traduccion_ingles": "cold" },
  { "palabra": "viento", "traduccion_ingles": "wind" },
  { "palabra": "lluvia", "traduccion_ingles": "rain" },
  { "palabra": "nieve", "traduccion_ingles": "snow" },
  { "palabra": "nube", "traduccion_ingles": "cloud" },
  { "palabra": "nublado", "traduccion_ingles": "cloudy" },
  { "palabra": "tormenta", "traduccion_ingles": "storm" },
  { "palabra": "casa", "traduccion_ingles": "house" },
  { "palabra": "piso", "traduccion_ingles": "flat / apartment" },
  { "palabra": "habitaci√≥n", "traduccion_ingles": "room" },
  { "palabra": "dormitorio", "traduccion_ingles": "bedroom" },
  { "palabra": "sal√≥n", "traduccion_ingles": "living room" },
  { "palabra": "comedor", "traduccion_ingles": "dining room" },
  { "palabra": "cocina", "traduccion_ingles": "kitchen" },
  { "palabra": "ba√±o", "traduccion_ingles": "bathroom" },
  { "palabra": "jard√≠n", "traduccion_ingles": "garden" },
  { "palabra": "pared", "traduccion_ingles": "wall" },
  { "palabra": "suelo", "traduccion_ingles": "floor" },
  { "palabra": "mesa", "traduccion_ingles": "table" },
  { "palabra": "silla", "traduccion_ingles": "chair" },
  { "palabra": "cama", "traduccion_ingles": "bed" },
  { "palabra": "sof√°", "traduccion_ingles": "sofa / couch" },
  { "palabra": "armario", "traduccion_ingles": "wardrobe / closet" },
  { "palabra": "estanter√≠a", "traduccion_ingles": "shelf / bookcase" },
  { "palabra": "l√°mpara", "traduccion_ingles": "lamp" },
  { "palabra": "espejo", "traduccion_ingles": "mirror" },
  { "palabra": "televisi√≥n", "traduccion_ingles": "television" },
  { "palabra": "nevera", "traduccion_ingles": "fridge" },
  { "palabra": "lavadora", "traduccion_ingles": "washing machine" },
  { "palabra": "m√≥vil", "traduccion_ingles": "mobile phone" },
  { "palabra": "llave", "traduccion_ingles": "key" },
  { "palabra": "reloj", "traduccion_ingles": "watch / clock" },
  { "palabra": "bolso", "traduccion_ingles": "bag / handbag" },
  { "palabra": "cartera", "traduccion_ingles": "wallet" },
  { "palabra": "paraguas", "traduccion_ingles": "umbrella" },
  { "palabra": "dinero", "traduccion_ingles": "money" },
  { "palabra": "tarjeta", "traduccion_ingles": "card (credit/debit)" },
  { "palabra": "libro", "traduccion_ingles": "book" },
  { "palabra": "cuaderno", "traduccion_ingles": "notebook" },
  { "palabra": "papel", "traduccion_ingles": "paper" },
  { "palabra": "bol√≠grafo", "traduccion_ingles": "pen" },
  { "palabra": "l√°piz", "traduccion_ingles": "pencil" },
  { "palabra": "ordenador", "traduccion_ingles": "computer" },
  { "palabra": "mochila", "traduccion_ingles": "backpack" },
  { "palabra": "ciudad", "traduccion_ingles": "city" },
  { "palabra": "pueblo", "traduccion_ingles": "town / village" },
  { "palabra": "barrio", "traduccion_ingles": "neighborhood" },
  { "palabra": "calle", "traduccion_ingles": "street" },
  { "palabra": "plaza", "traduccion_ingles": "square" },
  { "palabra": "parque", "traduccion_ingles": "park" },
  { "palabra": "tienda", "traduccion_ingles": "shop / store" },
  { "palabra": "supermercado", "traduccion_ingles": "supermarket" },
  { "palabra": "mercado", "traduccion_ingles": "market" },
  { "palabra": "escuela", "traduccion_ingles": "school" },
  { "palabra": "hospital", "traduccion_ingles": "hospital" },
  { "palabra": "farmacia", "traduccion_ingles": "pharmacy" },
  { "palabra": "banco", "traduccion_ingles": "bank" },
  { "palabra": "restaurante", "traduccion_ingles": "restaurant" },
  { "palabra": "bar", "traduccion_ingles": "bar / cafe" },
  { "palabra": "cine", "traduccion_ingles": "cinema / movie theater" },
  { "palabra": "hotel", "traduccion_ingles": "hotel" },
  { "palabra": "museo", "traduccion_ingles": "museum" },
  { "palabra": "aeropuerto", "traduccion_ingles": "airport" },
  { "palabra": "estaci√≥n", "traduccion_ingles": "station (train/bus)" },
  { "palabra": "coche", "traduccion_ingles": "car" },
  { "palabra": "autob√∫s", "traduccion_ingles": "bus" },
  { "palabra": "metro", "traduccion_ingles": "metro / subway" },
  { "palabra": "tren", "traduccion_ingles": "train" },
  { "palabra": "bicicleta", "traduccion_ingles": "bicycle" },
  { "palabra": "moto", "traduccion_ingles": "motorcycle" },
  { "palabra": "avi√≥n", "traduccion_ingles": "plane" },
  { "palabra": "taxi", "traduccion_ingles": "taxi" },
  { "palabra": "barco", "traduccion_ingles": "boat / ship" },
  { "palabra": "alto", "traduccion_ingles": "tall (male)" },
  { "palabra": "alta", "traduccion_ingles": "tall (female)" },
  { "palabra": "bajo", "traduccion_ingles": "short (height - male)" },
  { "palabra": "baja", "traduccion_ingles": "short (height - female)" },
  { "palabra": "gordo", "traduccion_ingles": "fat (male)" },
  { "palabra": "gorda", "traduccion_ingles": "fat (female)" },
  { "palabra": "delgado", "traduccion_ingles": "thin (male)" },
  { "palabra": "delgada", "traduccion_ingles": "thin (female)" },
  { "palabra": "guapo", "traduccion_ingles": "handsome" },
  { "palabra": "guapa", "traduccion_ingles": "beautiful / pretty" },
  { "palabra": "feo", "traduccion_ingles": "ugly (male)" },
  { "palabra": "joven", "traduccion_ingles": "young" },
  { "palabra": "mayor", "traduccion_ingles": "old / elderly" },
  { "palabra": "pelo", "traduccion_ingles": "hair" },
  { "palabra": "ojos", "traduccion_ingles": "eyes" },
  { "palabra": "rubio", "traduccion_ingles": "blonde (male)" },
  { "palabra": "morena", "traduccion_ingles": "brunette / dark-haired (female)" },
  { "palabra": "largo", "traduccion_ingles": "long" },
  { "palabra": "corto", "traduccion_ingles": "short (length)" },
  { "palabra": "barba", "traduccion_ingles": "beard" },
  { "palabra": "simp√°tico", "traduccion_ingles": "nice / friendly (male)" },
  { "palabra": "antip√°tico", "traduccion_ingles": "unfriendly / unpleasant" },
  { "palabra": "bueno", "traduccion_ingles": "good / kind" },
  { "palabra": "malo", "traduccion_ingles": "bad / mean" },
  { "palabra": "amable", "traduccion_ingles": "kind / polite" },
  { "palabra": "divertido", "traduccion_ingles": "fun / funny" },
  { "palabra": "aburrido", "traduccion_ingles": "boring" },
  { "palabra": "inteligente", "traduccion_ingles": "intelligent" },
  { "palabra": "trabajador", "traduccion_ingles": "hard-working (male)" },
  { "palabra": "vago", "traduccion_ingles": "lazy" },
  { "palabra": "alegre", "traduccion_ingles": "cheerful / happy" },
  { "palabra": "serio", "traduccion_ingles": "serious" },
  { "palabra": "t√≠mido", "traduccion_ingles": "shy" },
  { "palabra": "feliz", "traduccion_ingles": "happy" },
  { "palabra": "triste", "traduccion_ingles": "sad" },
  { "palabra": "rojo", "traduccion_ingles": "red" },
  { "palabra": "azul", "traduccion_ingles": "blue" },
  { "palabra": "verde", "traduccion_ingles": "green" },
  { "palabra": "amarillo", "traduccion_ingles": "yellow" },
  { "palabra": "blanco", "traduccion_ingles": "white" },
  { "palabra": "negro", "traduccion_ingles": "black" },
  { "palabra": "marr√≥n", "traduccion_ingles": "brown" },
  { "palabra": "gris", "traduccion_ingles": "grey" },
  { "palabra": "naranja", "traduccion_ingles": "orange" },
  { "palabra": "rosa", "traduccion_ingles": "pink" },
  { "palabra": "violeta", "traduccion_ingles": "violet / purple" },
  { "palabra": "camiseta", "traduccion_ingles": "t-shirt" },
  { "palabra": "camisa", "traduccion_ingles": "shirt" },
  { "palabra": "pantal√≥n", "traduccion_ingles": "trousers / pants" },
  { "palabra": "vaqueros", "traduccion_ingles": "jeans" },
  { "palabra": "falda", "traduccion_ingles": "skirt" },
  { "palabra": "vestido", "traduccion_ingles": "dress" },
  { "palabra": "zapatos", "traduccion_ingles": "shoes" },
  { "palabra": "zapatillas", "traduccion_ingles": "sneakers / trainers" },
  { "palabra": "abrigo", "traduccion_ingles": "coat" },
  { "palabra": "chaqueta", "traduccion_ingles": "jacket" },
  { "palabra": "jersey", "traduccion_ingles": "jumper / sweater" },
  { "palabra": "calcetines", "traduccion_ingles": "socks" },
  { "palabra": "bufanda", "traduccion_ingles": "scarf" },
  { "palabra": "gorro", "traduccion_ingles": "hat (winter/beanie)" },
  { "palabra": "guantes", "traduccion_ingles": "gloves" },
  { "palabra": "agua", "traduccion_ingles": "water" },
  { "palabra": "caf√©", "traduccion_ingles": "coffee" },
  { "palabra": "leche", "traduccion_ingles": "milk" },
  { "palabra": "t√©", "traduccion_ingles": "tea" },
  { "palabra": "zumo", "traduccion_ingles": "juice" },
  { "palabra": "vino", "traduccion_ingles": "wine" },
  { "palabra": "cerveza", "traduccion_ingles": "beer" },
  { "palabra": "pan", "traduccion_ingles": "bread" },
  { "palabra": "huevo", "traduccion_ingles": "egg" },
  { "palabra": "carne", "traduccion_ingles": "meat" },
  { "palabra": "pollo", "traduccion_ingles": "chicken" },
  { "palabra": "pescado", "traduccion_ingles": "fish (food)" },
  { "palabra": "fruta", "traduccion_ingles": "fruit" },
  { "palabra": "manzana", "traduccion_ingles": "apple" },
  { "palabra": "pl√°tano", "traduccion_ingles": "banana" },
  { "palabra": "lim√≥n", "traduccion_ingles": "lemon" },
  { "palabra": "verdura", "traduccion_ingles": "vegetables" },
  { "palabra": "ensalada", "traduccion_ingles": "salad" },
  { "palabra": "tomate", "traduccion_ingles": "tomato" },
  { "palabra": "patata", "traduccion_ingles": "potato" },
  { "palabra": "arroz", "traduccion_ingles": "rice" },
  { "palabra": "pasta", "traduccion_ingles": "pasta" },
  { "palabra": "queso", "traduccion_ingles": "cheese" },
  { "palabra": "az√∫car", "traduccion_ingles": "sugar" },
  { "palabra": "sal", "traduccion_ingles": "salt" },
  { "palabra": "aceite", "traduccion_ingles": "oil" },
  { "palabra": "chocolate", "traduccion_ingles": "chocolate" },
  { "palabra": "men√∫", "traduccion_ingles": "menu (set menu)" },
  { "palabra": "carta", "traduccion_ingles": "menu (a la carte)" },
  { "palabra": "cuenta", "traduccion_ingles": "bill / check" },
  { "palabra": "desayuno", "traduccion_ingles": "breakfast" },
  { "palabra": "almuerzo", "traduccion_ingles": "lunch" },
  { "palabra": "cena", "traduccion_ingles": "dinner" },
  { "palabra": "postre", "traduccion_ingles": "dessert" },
  { "palabra": "plato", "traduccion_ingles": "plate / dish" },
  { "palabra": "vaso", "traduccion_ingles": "glass" },
  { "palabra": "taza", "traduccion_ingles": "cup / mug" },
  { "palabra": "tenedor", "traduccion_ingles": "fork" },
  { "palabra": "cuchillo", "traduccion_ingles": "knife" },
  { "palabra": "cuchara", "traduccion_ingles": "spoon" },
  { "palabra": "servilleta", "traduccion_ingles": "napkin" },
  { "palabra": "rico", "traduccion_ingles": "tasty / good" },
  { "palabra": "delicioso", "traduccion_ingles": "delicious" },
  { "palabra": "ser", "traduccion_ingles": "to be (permanent)" },
  { "palabra": "estar", "traduccion_ingles": "to be (temporary/location)" },
  { "palabra": "tener", "traduccion_ingles": "to have" },
  { "palabra": "haber", "traduccion_ingles": "there is / there are" },
  { "palabra": "querer", "traduccion_ingles": "to want" },
  { "palabra": "poder", "traduccion_ingles": "to be able to / can" },
  { "palabra": "saber", "traduccion_ingles": "to know (facts/skills)" },
  { "palabra": "llamarse", "traduccion_ingles": "to be called" },
  { "palabra": "hablar", "traduccion_ingles": "to speak" },
  { "palabra": "comer", "traduccion_ingles": "to eat" },
  { "palabra": "beber", "traduccion_ingles": "to drink" },
  { "palabra": "vivir", "traduccion_ingles": "to live" },
  { "palabra": "ir", "traduccion_ingles": "to go" },
  { "palabra": "venir", "traduccion_ingles": "to come" },
  { "palabra": "hacer", "traduccion_ingles": "to do / to make" },
  { "palabra": "dormir", "traduccion_ingles": "to sleep" },
  { "palabra": "levantarse", "traduccion_ingles": "to get up" },
  { "palabra": "ducharse", "traduccion_ingles": "to take a shower" },
  { "palabra": "trabajar", "traduccion_ingles": "to work" },
  { "palabra": "gustar", "traduccion_ingles": "to like" },
  { "palabra": "leer", "traduccion_ingles": "to read" },
  { "palabra": "escribir", "traduccion_ingles": "to write" },
  { "palabra": "escuchar", "traduccion_ingles": "to listen" },
  { "palabra": "mirar", "traduccion_ingles": "to look / to watch" },
  { "palabra": "ver", "traduccion_ingles": "to see / to watch" },
  { "palabra": "estudiar", "traduccion_ingles": "to study" },
  { "palabra": "aprender", "traduccion_ingles": "to learn" },
  { "palabra": "jugar", "traduccion_ingles": "to play" },
  { "palabra": "comprar", "traduccion_ingles": "to buy" },
  { "palabra": "viajar", "traduccion_ingles": "to travel" },
  { "palabra": "salir", "traduccion_ingles": "to go out / leave" },
  { "palabra": "llegar", "traduccion_ingles": "to arrive" },
  { "palabra": "entrar", "traduccion_ingles": "to enter" },
  { "palabra": "bien", "traduccion_ingles": "well / good" },
  { "palabra": "mal", "traduccion_ingles": "bad / poorly" },
  { "palabra": "regular", "traduccion_ingles": "so-so / okay" },
  { "palabra": "contento", "traduccion_ingles": "happy / content" },
  { "palabra": "cansado", "traduccion_ingles": "tired" },
  { "palabra": "enfadado", "traduccion_ingles": "angry" },
  { "palabra": "nervioso", "traduccion_ingles": "nervous" },
  { "palabra": "tranquilo", "traduccion_ingles": "calm / relaxed" },
  { "palabra": "ocupado", "traduccion_ingles": "busy" },
  { "palabra": "enfermo", "traduccion_ingles": "sick / ill" },
  { "palabra": "hambre", "traduccion_ingles": "hunger" },
  { "palabra": "sed", "traduccion_ingles": "thirst" },
  { "palabra": "sue√±o", "traduccion_ingles": "sleepiness" },
  { "palabra": "miedo", "traduccion_ingles": "fear" },
  { "palabra": "prisa", "traduccion_ingles": "hurry" },
  { "palabra": "aqu√≠", "traduccion_ingles": "here" },
  { "palabra": "all√≠", "traduccion_ingles": "there" },
  { "palabra": "cerca", "traduccion_ingles": "near / close" },
  { "palabra": "lejos", "traduccion_ingles": "far" },
  { "palabra": "delante", "traduccion_ingles": "in front" },
  { "palabra": "detr√°s", "traduccion_ingles": "behind" },
  { "palabra": "enfrente", "traduccion_ingles": "opposite / facing" },
  { "palabra": "encima", "traduccion_ingles": "on top of" },
  { "palabra": "debajo", "traduccion_ingles": "under / underneath" },
  { "palabra": "dentro", "traduccion_ingles": "inside" },
  { "palabra": "fuera", "traduccion_ingles": "outside" },
  { "palabra": "entre", "traduccion_ingles": "between" },
  { "palabra": "en", "traduccion_ingles": "in / on / at" }
];

    // --- UTILIDADES ---
    
    function normalize(str) {
        return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();
    }

    function getRandomElement(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
    }

    // --- L√ìGICA DEL JUEGO (ANAGRAMA PARCIAL) ---

    function generateCrosswordLogic() {
        const singleWords = vocabulario.filter(v => !v.palabra.includes(" ") && !v.palabra.includes("?"));
        const longWords = singleWords.filter(v => v.palabra.length >= 7); // Subimos m√≠nimamente el requisito para asegurar juego
        
        if (longWords.length === 0) return null;

        const MAX_ATTEMPTS = 200; // M√°s intentos porque el filtro es estricto
        let attempt = 0;

        while (attempt < MAX_ATTEMPTS) {
            attempt++;
            
            // 1. Seleccionar palabra base
            const baseWordObj = getRandomElement(longWords);
            const baseWord = normalize(baseWordObj.palabra);
            
            // Crear Set de letras de la base para validaci√≥n r√°pida
            const baseCharsSet = new Set(baseWord.split(''));

            // 2. Filtrar pool de palabras V√ÅLIDAS (Deben ser subset de la base)
            const validPool = singleWords.filter(v => {
                const normV = normalize(v.palabra);
                
                // Condici√≥n 1: M√°s corta que la base
                if (normV.length >= baseWord.length) return false;
                if (normV.length < 2) return false; // Ignorar letras sueltas si existen

                // Condici√≥n 2: TODAS las letras de la palabra candidata deben existir en la base
                for (let char of normV) {
                    if (!baseCharsSet.has(char)) return false;
                }
                
                return true;
            });

            // Si no hay suficientes palabras que se puedan formar con la base, intentamos otra base
            if (validPool.length < 3) continue; 

            // --- Inicio Algoritmo de Colocaci√≥n ---
            
            let placedWords = [];
            placedWords.push({
                wordObj: baseWordObj,
                x: 0,
                y: 0,
                dir: 'H',
                normalized: baseWord
            });

            let usedWords = [baseWordObj.palabra];
            let intersectCount = 0;
            let retriesInBase = 0;

            // Intentamos colocar hasta 4 palabras verticales
            while (intersectCount < 4 && retriesInBase < 50) {
                retriesInBase++;

                // Elegir candidata del pool validado
                const candidateObj = getRandomElement(validPool);
                if (usedWords.includes(candidateObj.palabra)) continue;

                const candidateNorm = normalize(candidateObj.palabra);
                
                // Buscar punto de cruce
                // Iteramos sobre las letras de la candidata para ver si alguna coincide con alguna de la base
                // (La base siempre est√° en placedWords[0])
                
                let placed = false;
                
                // Mezclamos el orden de chequeo para variedad
                const baseIndices = Array.from({length: baseWord.length}, (_, i) => i).sort(() => Math.random() - 0.5);

                for (let i of baseIndices) {
                    const charBase = baseWord[i];
                    
                    if (candidateNorm.includes(charBase)) {
                        const charIndexCand = candidateNorm.indexOf(charBase);
                        
                        // Coordenadas propuestas para la vertical
                        // Base est√° en y=0. Cruza en x=i.
                        // La vertical debe empezar en y = -charIndexCand para que su letra coincida en y=0
                        const proposedWord = {
                            wordObj: candidateObj,
                            x: i,
                            y: -charIndexCand,
                            dir: 'V',
                            normalized: candidateNorm
                        };

                        // Validaci√≥n de espacio (simplificada para estructura peine: 1 Horiz, N Verts)
                        // Chequear que no est√© pegada a otra vertical (x debe distar > 1)
                        const collision = placedWords.some(pw => {
                            if (pw.dir === 'H') return false; // Ignorar la base misma
                            return Math.abs(pw.x - proposedWord.x) < 2; // M√≠nimo 1 espacio entre columnas
                        });

                        if (!collision) {
                            placedWords.push(proposedWord);
                            usedWords.push(candidateObj.palabra);
                            intersectCount++;
                            placed = true;
                            break; 
                        }
                    }
                }
            }

            // Si logramos al menos 2 cruces, es un juego v√°lido
            if (intersectCount >= 2) {
                return { words: placedWords, baseWord: baseWordObj.palabra.toUpperCase() };
            }
        }
        
        console.log("Fall√≥ la generaci√≥n, reintentando...");
        return null;
    }

    let currentWords = [];

    function initGame() {
        const result = generateCrosswordLogic();
        
        if (!result) {
            // Reintento autom√°tico si no encuentra combinaci√≥n (puede pasar con azar)
            setTimeout(initGame, 50);
            return;
        }
        
        currentWords = result.words;
        
        // Mostrar info de la palabra base
        document.getElementById('base-word-display').innerHTML = 
            `Palabra Base: <strong>${result.baseWord}</strong><br>
             <small>(Todas las dem√°s palabras usan letras de esta)</small>`;

        renderGrid(currentWords);
        renderClues(currentWords);
    }

    function renderGrid(words) {
        const gridContainer = document.getElementById('crossword-grid');
        gridContainer.innerHTML = '';

        let minX = Infinity, maxX = -Infinity, minY = Infinity, maxY = -Infinity;

        words.forEach(w => {
            const len = w.normalized.length;
            const xEnd = w.dir === 'H' ? w.x + len - 1 : w.x;
            const yEnd = w.dir === 'V' ? w.y + len - 1 : w.y;

            minX = Math.min(minX, w.x);
            maxX = Math.max(maxX, xEnd);
            minY = Math.min(minY, w.y);
            maxY = Math.max(maxY, yEnd);
        });

        const width = maxX - minX + 1;
        const height = maxY - minY + 1;

        gridContainer.style.gridTemplateColumns = `repeat(${width}, var(--cell-size))`;
        gridContainer.style.gridTemplateRows = `repeat(${height}, var(--cell-size))`;

        const cellMap = new Map();

        words.forEach((w, index) => {
            const len = w.normalized.length;
            for (let i = 0; i < len; i++) {
                const posX = (w.dir === 'H' ? w.x + i : w.x) - minX;
                const posY = (w.dir === 'V' ? w.y + i : w.y) - minY;
                const char = w.normalized[i];
                const key = `${posX},${posY}`;

                let cellDiv = cellMap.get(key);
                
                if (!cellDiv) {
                    cellDiv = document.createElement('div');
                    cellDiv.className = 'cell';
                    cellDiv.style.gridColumnStart = posX + 1;
                    cellDiv.style.gridRowStart = posY + 1;

                    const input = document.createElement('input');
                    input.type = 'text';
                    input.maxLength = 1;
                    input.className = 'cell-input';
                    input.dataset.correct = char;
                    
                    // Auto-tabulaci√≥n simple
                    input.addEventListener('input', function() {
                        if(this.value.length === 1) {
                            // L√≥gica b√°sica para saltar al siguiente input (no direccional estricta)
                            /* En un crucigrama real esto es complejo, aqu√≠ lo dejamos manual */
                        }
                    });

                    cellDiv.appendChild(input);
                    gridContainer.appendChild(cellDiv);
                    cellMap.set(key, cellDiv);
                }

                if (i === 0) {
                    const numSpan = document.createElement('span');
                    numSpan.className = 'cell-number';
                    numSpan.innerText = index + 1;
                    if(!cellDiv.querySelector('.cell-number')) {
                        cellDiv.appendChild(numSpan);
                    }
                }
            }
        });
    }

    function renderClues(words) {
        const hContainer = document.getElementById('clues-horizontal');
        const vContainer = document.getElementById('clues-vertical');
        hContainer.innerHTML = '';
        vContainer.innerHTML = '';

        words.forEach((w, index) => {
            const div = document.createElement('div');
            div.className = 'clue-item';
            div.innerHTML = `<span class="clue-badge">${index + 1}</span> ${w.wordObj.traduccion_ingles}`;
            
            if (w.dir === 'H') {
                hContainer.appendChild(div);
            } else {
                vContainer.appendChild(div);
            }
        });
    }

    function checkAnswers() {
        const inputs = document.querySelectorAll('.cell-input');
        inputs.forEach(input => {
            const userVal = normalize(input.value);
            const correctVal = input.dataset.correct;
            const parent = input.parentElement;

            parent.classList.remove('correct', 'incorrect');

            if (userVal === '') {
                // vac√≠o
            } else if (userVal === correctVal) {
                parent.classList.add('correct');
            } else {
                parent.classList.add('incorrect');
            }
        });
    }

    window.onload = initGame;

</script>
</body>
</html>
